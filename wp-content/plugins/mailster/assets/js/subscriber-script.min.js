mailster=function(e,s,i,t){"use strict";var a,o=s("#email"),r=s("#ID").val(),n=s(".avatar"),l=s("form#subscriber_form");s.easyPieChart&&s(".piechart").easyPieChart({animate:1e3,rotate:180,barColor:e.colors.main,trackColor:e.colors.track_light,lineWidth:9,size:75,lineCap:"butt",onStep:function(i){this.$el.find("span").text(Math.round(i))},onStop:function(i){this.$el.find("span").text(Math.round(i))}});s("#subscriber_form").on("submit",function(){clearTimeout(a);o.off("blur").off("keyup");s(this).submit(false)});s(".detail").on("click",function(){var i=s(this).addClass("active"),t=i.find(".click-to-edit"),e=t.find("> li").first(),a=t.find("> li").last();if(!e.is(":hidden")){e.hide();a.show().find("input").first().focus().select();a.show().find("textarea").first().focus().select()}});s("#mailster_status").on("change",function(){if(s(this).val()<=0){s(".pending-info").show()}else{s(".pending-info").hide()}});s(".show-more-info").on("click",function(){s(".more-info").slideToggle(100)});s(".map.zoomable").on("click",function(){var i=s(this),t=i.find("img"),e=t.attr("src"),a=t.data("zoom");if(!t.hasClass("zoomed")){t.attr("src",a).data("zoom",e).addClass("zoomed")}else{t.attr("src",a).data("zoom",e).removeClass("zoomed")}});s.fn.select2&&s(".tags-input").select2({placeholder:e.l10n.subscribers.choose_tags,tags:true,theme:"mailster"});o.on("blur",function(){var i=s(this),t=e.util.trim(i.val());s(this).val(t);if(n.data("email")!=t){n.addClass("avatar-loading");c(t,function(i){if(i.success)n.data("email",t).removeClass("avatar-loading").css({"background-image":"url("+i.data.url.replace(/&amp;/,"&")+")"})})}if(!t)l.prop("disabled",true);i.trigger("keyup")}).on("keyup",function(){var t=s(this);clearTimeout(a);a=setTimeout(function(){var i=e.util.trim(t.val());e.util.ajax("check_email",{email:i,id:r},function(i){l.prop("disabled",i.exists);s(".email-error").slideUp(100,function(){s(this).remove()});if(i.exists){s('<p class="email-error">&#9650; '+e.l10n.subscribers.email_exists+"</p>").hide().insertAfter(t).slideDown(100);setTimeout(function(){t.focus(),1})}})},400);l.prop("disabled",true)});function c(i,t){e.util.ajax("get_gravatar",{email:i},t)}return e}(mailster||{},jQuery,window,document);