mailster=function(s,n,i,e){"use strict";var a=n(".status");s.events.push("documentReady",r);s.$.document.on("change","#delete-subscribers input,#delete-subscribers select",r).on("submit","#delete-subscribers",function(){var e=prompt(s.l10n.manage.confirm_delete);if(!e)return false;if("delete"==e.toLowerCase()){var t=n("#delete-subscribers").serialize();a.addClass("progress spinner");s.util.ajax("delete_contacts",{data:t,conditions:s.conditions.serialize()},function(e){if(e.success){a.html(e.data.msg)}else{a.html(e.data.msg)}a.removeClass("spinner");r()},function(e,t,s){a.html("["+e.status+"] "+s)})}return false}).on("click",".remove-job",function(){if(!confirm(s.l10n.manage.confirm_job_delete))return false;var t=n(this).closest(".manage-job");s.util.ajax("delete_delete_job",{id:t.data("id")},function(e){if(e.success){t.slideUp(function(){t.remove()})}},function(e,t,s){});return false}).on("click","#schedule-delete-subscriber-button",function(){var e=n("#delete-subscribers").serialize();if(!/&lists%5B%5D/.test(e)&&!/&nolists=1/.test(e)){alert(s.l10n.manage.list_required);return false}if(!/&status%5B%5D/.test(e)){alert(s.l10n.manage.status_required);return false}var t=prompt(s.l10n.manage.confirm_job,s.util.sprintf(s.l10n.manage.confirm_job_default,n(".manage-job").length+1));if(!t)return false;a.addClass("progress spinner");s.util.ajax("delete_contacts",{schedule:true,name:t,data:e,conditions:s.conditions.serialize()},function(e){a.removeClass("spinner");if(e.success){a.html(e.data.msg);i.location.reload()}else{a.html(e.data.msg)}},function(e,t,s){a.html("["+e.status+"] "+s)});return false});s.events.push("updateConditions",r);function r(){setTimeout(function(){var e=n("#delete-subscribers").serialize();n("#delete-subscriber-button").prop("disabled",true);s.util.ajax("get_subscriber_count",{data:e,conditions:s.conditions.serialize()},function(e){if(e.success){n("#delete-subscriber-button").val(s.util.sprintf(s.l10n.manage.delete_n_subscribers,e.data.count_formated)).prop("disabled",!e.data.count)}})},10)}return s}(mailster||{},jQuery,window,document);